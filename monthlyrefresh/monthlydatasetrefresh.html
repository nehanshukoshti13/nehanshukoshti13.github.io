<!DOCTYPE html>
<html lang="en" class="no-js">

<head>
	<meta charset="UTF-8" />
	<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
	<title>Monthly dataset refresh</title>
	<meta name="description" content="Blog, techincal, power bi, ms flow" />
	<meta name="keywords" content="MS Flow, Power BI" />
	<meta name="author" content="Adit Pandey" />

	<!--Favicon-->
	<link rel="shortcut icon" href="favicon.ico">
	<link rel="icon" href="favicon.ico" type="image/x-icon">

	<!--Fonts-->
	<link href='https://fonts.googleapis.com/css?family=Oswald:300,400,500,600,700|Hind:400,500,300,600'
		rel='stylesheet' type='text/css'>

	<!--CSS-->
	<link rel="stylesheet" type="text/css" href="../css/blogstyle.css" />

</head>

<body id="body" data-ng-app="contactApp">

	<!--Fixed Bg Image-->
	<div class="fixed-bg"></div>
	<div class="fixed-bg-overlay"></div>
	<!--/Fixed Bg Image-->

	<!--Preloader-->
	<div id="pre_load" class="preloader-it">
		<div id="la_anim" class="la-anim-1"></div>
	</div>
	<!--/Preloader-->

	<!--Container-->
	<div class="container-fluid">
		<div class="row">

			<div class="col-lg-12 col-xs-12 pad-zero">

				<!--Header-->
				<header>
					<div class="header-wrap col-lg-10 center-div">
						<div class="float-left name">
							<a data-scroll href="#body">
								<span>
									Monthly dataset refresh using MS flow
								</span>
							</a>
						</div>
					</div>
					<div class="clearfix"></div>
				</header>
				<!--/Header-->

				<!--Main Content-->
				<div id="main_content" class="content-block margin-top-150 margin-top-sm-70 margin-top-xs-50">

					<!--Introduction Sec-->

					<!--/Introduction Sec-->

					<hr class="separater-hr" />

					<!--WhatWeDo Sec-->
					<!--/WhatWeDo Sec-->
					<!--Skills Sec-->
					<section id="skill_sec"  class="col-lg-10 col-md-11 col-sm-11 center-div skills-wrap  sec-pad-top sec-pad-bottom-xs">
						<h6></h6>
						<p class="wow fadeInUp" data-wow-duration=".4s">
							To schedule a refresh for a dataset/dataflow in Power Bi we have options to set refresh on a daily/weelkly basis, but if requirement is to refresh the dataset on a monthly basis or on a particular day of month  (e.g., first tuesday of a month) we can use MS flow to achieve the required solution as follows.</br>
						</br>
						To use MS flow to refresh a dataset in Power BI login to MS flow <a href="https://flow.microsoft.com">flow.microsoft.com</a> using an account with access to dataset you want to refresh.</br>
						To create a flow to refresh data create new flow and select scheduled flow option.					
						</p>
						<div class="row margin-top-40">
							<div class="clearfix"></div>
						
							<div class="col-lg-10 col-md-11 col-sm-11 margin-bottom-sm">
								<img src="images/createflow.png" style="height: 100%; width:100%;" />
								<span class="progress-cat">Create new flow</span>
							</div>
						</div>
						<p class="wow fadeInUp" data-wow-duration=".4s">
							To refresh the dataset on a specific date of the month, select run Monthly and add the date you want to refresh the dataset in Start date as follows
						</p>
						<div class="row margin-top-40">
							<div class="clearfix"></div>
						
							<div class="col-lg-10 col-md-11 col-sm-11 margin-bottom-sm">
								<img src="images/1st of everymonth image.PNG" style="height: 100%; width:100%;" />
								<span class="progress-cat">Run flow monthly</span>
							</div>
						</div>

						<p class="wow fadeInUp" data-wow-duration=".4s">
							After the flow is created, click +new step button to add a new step. In the Choose an action search bar search Power BI and select Refresh a dataset action. Create a connection, as the account used to create flow has permissions to the workspace and dataset the connection will be succesfully created. 
							Once connection is created select the workspace and datataset you want to refresh from the dropdowns.
							Save the flow and the refresh on desired date of the month is scheduled
						</p>
						<div class="row margin-top-40">
							<div class="clearfix"></div>
						
							<div class="col-lg-10 col-md-11 col-sm-11 margin-bottom-sm">
								<img src="images/added conector imag.PNG" style="height: 100%; width:100%;" />
								<span class="progress-cat">Connector to refresh dataset</span>
							</div>
						</div>


						<p class="wow fadeInUp" data-wow-duration=".4s">
							To refresh the dataset on a particular day of month e.g. first of every month create a flow to run every day as follows
						</p>
						<div class="row margin-top-40">
							<div class="clearfix"></div>
						
							<div class="col-lg-10 col-md-11 col-sm-11 margin-bottom-sm">
								<img src="images/everyday image.PNG" style="height: 100%; width:100%;" />
								<span class="progress-cat">Run flow daily</span>
							</div>
						</div>
						<p class="wow fadeInUp" data-wow-duration=".4s">
							Once the flow is created click on +new step and add a condition action from the Choose an action window.</br>
							To refresh report on first tuesday of the month add <b style="color: red;">int(utcNow('dd'))</b>, in the condition window, select is less than from the center dropdown and add <b style="color: red;">8</b> in the last box.</br>
							</p>
							<div class="row margin-top-40">
								<div class="clearfix"></div>
							
								<div class="col-lg-10 col-md-11 col-sm-11 margin-bottom-sm">
									<img src="images/utcnow dd.PNG" style="height: 100%; width:100%;" />
									<span class="progress-cat">Check for the first week</span>
								</div>
							</div>
							<p>
							Add another row in the condition window and add <b style="color: red;">utcNow('dddd'))</b>, in the center select equals and add <b style="color: red;">Tuesday</b>. You can add any day you want to refresh the dataset on here.</br>
						</p>
						<div class="row margin-top-40">
							<div class="clearfix"></div>
						
							<div class="col-lg-10 col-md-11 col-sm-11 margin-bottom-sm">
								<img src="images/utc now dddd.PNG" style="height: 100%; width:100%;" />
								<span class="progress-cat">Check for specific day of week</span>
							</div>
						</div>
						<p>
							Once the condition is added, in if yes section click Add an action and add refresh Power BI dataset action and select the desired dataset and workspace as mentioned above. 
						</p>

						<div class="row margin-top-40">
							<div class="clearfix"></div>
						
							<div class="col-lg-10 col-md-11 col-sm-11 margin-bottom-sm">
								<img src="images/final image.PNG" style="height: 100%; width:100%;" />
								<span class="progress-cat">Add refresh dataset action</span>
							</div>
						</div>

						<p>Save the flow and the dataset will be refreshed on the first tuesday of each month.</br>
						To refresh a data set we have prebuilt connector that we can use. To refresh a dataflow, create a custom connector to use Power BI Api as suggested <a href="http://aditpandey.github.io/customconnector/createcustomconnector.html" style="color: red;">here</a>.</br>
						</p>
						<div class="row margin-top-40">
							<div class="clearfix"></div>
						
							<div class="col-lg-10 col-md-11 col-sm-11 margin-bottom-sm">
								<img src="images/customconnector.PNG" style="height: 100%; width:100%;" />
								<span class="progress-cat">Use custom connector to refresh dataflow</span>
							</div>
						</div>
						<p>After creating custom connector add the custom connector in place of the power bi action and add the dataflow id and workspace id in the parameters and save the flow.</br>
						Hope this helps you achieve your requirement of refreshing your dataset/dataflow monthly.</br> 
						Thank you. For any help or querry feel free to reach me at my email or whatsapp me at my number.
						</p>
						<div class="clearfix"></div>
						
					</section> 
					<!--/Skills Sec-->



					<!--Qualfication Sec-->
					<!--/Qualfication Sec-->

					<hr class="separater-hr" />





				<hr class="separater-hr" />

				<!--Contact Sec-->
				<section id="contact_sec" class="col-lg-10 col-md-11 col-sm-11 center-div contact-wrap sec-pad">
					<h6>contact</h6>
					<div class="email-direct">
						<p class="wow fadeInRight" data-wow-duration=".4s">Email me at <a
								href="mailto:aditp7566@gmail.com">aditp7566@gmail.com</a></p>
						<p class="wow fadeInRight" data-wow-duration=".4s"><a href="https://aditpandey.github.io">About
								me</a></p>
					</div>
				</section>
				<!--Contact Sec-->

				<hr class="separater-hr" />

				<!--Footer-->
				<footer class="col-lg-10 col-md-11 col-sm-11 center-div contact-wrap  sec-pad">
					<div class="row">
						<div class="col-sm-6 available-wrap">
							<!--<span class="available-pointer"></span>
										<span class="available-tag">Available for Employment.</span>--!>
									</div>
									<div class="col-sm-6">
										<div class="goto-top text-right float-right">
											<a data-scroll href="#body">
												<span data-hover="top">
													top
												</span>
											</a>
										</div>
										<div class="copywrite-wrap text-right float-right">
											<p class="copywrite"></b> Updated <b>June, 2020.</b></p>
										</div>
									</div>
								</div>
							</footer>
							<!--/Footer-->

						</div>
						<!--/Main Content-->

					</div>
			</div></div>
		</div>
		<!-- /Container -->

		<!-- Scripts -->
		<script src="../js/jquery-1.12.4.min.js"></script>
		<script src="../js/angular.min.js"></script>
		<script src="../js/bootstrap.min.js"></script>
		<script src="../js/modernizr.custom.js"></script>
		<script src="../js/app.js"></script>
		<script src="../js/controllers.js"></script>
		<script src="../js/jquery.placeholder.js"></script>
		<script src="../js/smooth-scroll.js"></script>
		<script src="../js/countTo.js"></script>
		<script src="../js/jQuery.appear.js"></script>
		<script src="../js/isotope.js"></script>
		<script src="../js/typed.js"></script>
		<script src="../js/lightgallery-all.js"></script>
		<script src="../js/jquery.mousewheel.min.js"></script>
		<script src="../js/owl.carousel.min.js"></script>
		<script src="../js/froogaloop2.min.js"></script>
		<script src="../js/wow.min.js"></script>
		<script src="../js/init.js"></script>
</body>

</html>